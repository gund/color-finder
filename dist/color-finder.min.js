var CanvasImage=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(t){this.context.putImageData(t,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};if(ColorThief.prototype.getColor=function(t,r){var o=this.getPalette(t,5,r),n=o[0];return n},ColorThief.prototype.getPalette=function(t,r,o){"undefined"==typeof r&&(r=10),("undefined"==typeof o||1>o)&&(o=10);for(var n,e,a,i,u,c=new CanvasImage(t),f=c.getImageData(),s=f.data,v=c.getPixelCount(),h=[],p=0;v>p;p+=o)n=4*p,e=s[n+0],a=s[n+1],i=s[n+2],u=s[n+3],u>=125&&(e>250&&a>250&&i>250||h.push([e,a,i]));var l=MMCQ.quantize(h,r),g=l?l.palette():null;return c.removeCanvas(),g},!pv)var pv={map:function(t,r){var o={};return r?t.map(function(t,n){return o.index=n,r.call(o,t)}):t.slice()},naturalOrder:function(t,r){return r>t?-1:t>r?1:0},sum:function(t,r){var o={};return t.reduce(r?function(t,n,e){return o.index=e,t+r.call(o,n)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?pv.map(t,r):t)}};var MMCQ=function(){function t(t,r,o){return(t<<2*c)+(r<<c)+o}function r(t){function r(){o.sort(t),n=!0}var o=[],n=!1;return{push:function(t){o.push(t),n=!1},peek:function(t){return n||r(),void 0===t&&(t=o.length-1),o[t]},pop:function(){return n||r(),o.pop()},size:function(){return o.length},map:function(t){return o.map(t)},debug:function(){return n||r(),o}}}function o(t,r,o,n,e,a,i){var u=this;u.r1=t,u.r2=r,u.g1=o,u.g2=n,u.b1=e,u.b2=a,u.histo=i}function n(){this.vboxes=new r(function(t,r){return pv.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())})}function e(r){var o,n,e,a,i=1<<3*c,u=new Array(i);return r.forEach(function(r){n=r[0]>>f,e=r[1]>>f,a=r[2]>>f,o=t(n,e,a),u[o]=(u[o]||0)+1}),u}function a(t,r){var n,e,a,i=1e6,u=0,c=1e6,s=0,v=1e6,h=0;return t.forEach(function(t){n=t[0]>>f,e=t[1]>>f,a=t[2]>>f,i>n?i=n:n>u&&(u=n),c>e?c=e:e>s&&(s=e),v>a?v=a:a>h&&(h=a)}),new o(i,u,c,s,v,h,r)}function i(r,o){function n(t){var r,n,e,a,i,u=t+"1",f=t+"2",s=0;for(c=o[u];c<=o[f];c++)if(l[c]>p/2){for(e=o.copy(),a=o.copy(),r=c-o[u],n=o[f]-c,i=n>=r?Math.min(o[f]-1,~~(c+n/2)):Math.max(o[u],~~(c-1-r/2));!l[i];)i++;for(s=g[i];!s&&l[i-1];)s=g[--i];return e[f]=i,a[u]=e[f]+1,[e,a]}}if(o.count()){var e=o.r2-o.r1+1,a=o.g2-o.g1+1,i=o.b2-o.b1+1,u=pv.max([e,a,i]);if(1==o.count())return[o.copy()];var c,f,s,v,h,p=0,l=[],g=[];if(u==e)for(c=o.r1;c<=o.r2;c++){for(v=0,f=o.g1;f<=o.g2;f++)for(s=o.b1;s<=o.b2;s++)h=t(c,f,s),v+=r[h]||0;p+=v,l[c]=p}else if(u==a)for(c=o.g1;c<=o.g2;c++){for(v=0,f=o.r1;f<=o.r2;f++)for(s=o.b1;s<=o.b2;s++)h=t(f,c,s),v+=r[h]||0;p+=v,l[c]=p}else for(c=o.b1;c<=o.b2;c++){for(v=0,f=o.r1;f<=o.r2;f++)for(s=o.g1;s<=o.g2;s++)h=t(f,s,c),v+=r[h]||0;p+=v,l[c]=p}return l.forEach(function(t,r){g[r]=p-t}),n(u==e?"r":u==a?"g":"b")}}function u(t,o){function u(t,r){for(var o,n=1,e=0;s>e;)if(o=t.pop(),o.count()){var a=i(c,o),u=a[0],f=a[1];if(!u)return;if(t.push(u),f&&(t.push(f),n++),n>=r)return;if(e++>s)return}else t.push(o),e++}if(!t.length||2>o||o>256)return!1;var c=e(t),f=0;c.forEach(function(){f++});var h=a(t,c),p=new r(function(t,r){return pv.naturalOrder(t.count(),r.count())});p.push(h),u(p,v*o);for(var l=new r(function(t,r){return pv.naturalOrder(t.count()*t.volume(),r.count()*r.volume())});p.size();)l.push(p.pop());u(l,o-l.size());for(var g=new n;l.size();)g.push(l.pop());return g}var c=5,f=8-c,s=1e3,v=.75;return o.prototype={volume:function(t){var r=this;return(!r._volume||t)&&(r._volume=(r.r2-r.r1+1)*(r.g2-r.g1+1)*(r.b2-r.b1+1)),r._volume},count:function(r){var o=this,n=o.histo;if(!o._count_set||r){var e,a,i,u=0;for(e=o.r1;e<=o.r2;e++)for(a=o.g1;a<=o.g2;a++)for(i=o.b1;i<=o.b2;i++)index=t(e,a,i),u+=n[index]||0;o._count=u,o._count_set=!0}return o._count},copy:function(){var t=this;return new o(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(r){var o=this,n=o.histo;if(!o._avg||r){var e,a,i,u,f,s=0,v=1<<8-c,h=0,p=0,l=0;for(a=o.r1;a<=o.r2;a++)for(i=o.g1;i<=o.g2;i++)for(u=o.b1;u<=o.b2;u++)f=t(a,i,u),e=n[f]||0,s+=e,h+=e*(a+.5)*v,p+=e*(i+.5)*v,l+=e*(u+.5)*v;s?o._avg=[~~(h/s),~~(p/s),~~(l/s)]:o._avg=[~~(v*(o.r1+o.r2+1)/2),~~(v*(o.g1+o.g2+1)/2),~~(v*(o.b1+o.b2+1)/2)]}return o._avg},contains:function(t){var r=this,o=t[0]>>f;return gval=t[1]>>f,bval=t[2]>>f,o>=r.r1&&o<=r.r2&&gval>=r.g1&&gval<=r.g2&&bval>=r.b1&&bval<=r.b2}},n.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,o=0;o<r.size();o++)if(r.peek(o).vbox.contains(t))return r.peek(o).color;return this.nearest(t)},nearest:function(t){for(var r,o,n,e=this.vboxes,a=0;a<e.size();a++)o=Math.sqrt(Math.pow(t[0]-e.peek(a).color[0],2)+Math.pow(t[1]-e.peek(a).color[1],2)+Math.pow(t[2]-e.peek(a).color[2],2)),(r>o||void 0===r)&&(r=o,n=e.peek(a).color);return n},forcebw:function(){var t=this.vboxes;t.sort(function(t,r){return pv.naturalOrder(pv.sum(t.color),pv.sum(r.color))});var r=t[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(t[0].color=[0,0,0]);var o=t.length-1,n=t[o].color;n[0]>251&&n[1]>251&&n[2]>251&&(t[o].color=[255,255,255])}},{quantize:u}}();!function(){"use strict";function t(){}var r=function(t){return Error("ColorFinder: "+t)},o=Object.seal({maxColorValue:230});t.prototype.setConfig=function(t,n){if(void 0===o[t])throw r("setConfig: Invalid config key");return o[t]=n,this},t.prototype.getConfig=function(t){if(void 0===o[t])throw r("setConfig: Invalid config key");return o[t]},t.prototype.fromImage=function(t,o){if(!t)throw r("fromImage: Invalid image url");if("function"!=typeof o)throw r("fromImage: Invalid callback");return this._getPopularColor(t,o),this},t.prototype._getPopularColor=function(t,r){if(t){var n=this,e=new Image;e.onload=function(){r(n._normalizeColor(ColorThief.prototype.getColor(e),o.maxColorValue))},e.crossOrigin="",e.src=t}},t.prototype._normalizeColor=function(t,o){if(!(t instanceof Array)||t.length<3)throw r("normalizeColor: Invalid color");if(void 0===o)throw r("normalizeColor: Invalid maxColor");var n=this._arrayMax(t);if(o>=n)return t;var e=n-o;return t[0]=Math.max(t[0]-e,0),t[1]=Math.max(t[1]-e,0),t[2]=Math.max(t[2]-e,0),t},t.prototype._buildHistogram=function(t,r){for(var o,n,e,a,i={r:[],g:[],b:[],a:[]},u=t.length;u;)a=t[--u],e=t[--u],n=t[--u],o=t[--u],i.r[o]=void 0!==i.r[o]?i.r[o]+o/r:o/r,i.g[n]=void 0!==i.g[n]?i.g[n]+n/r:n/r,i.b[e]=void 0!==i.b[e]?i.b[e]+e/r:e/r,i.a[a]=void 0!==i.a[a]?i.a[a]+a/r:a/r;return i},t.prototype._readBlobAsync=function(t,r){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===this.readyState&&200===this.status&&r(this.response)},o.open("GET",t),o.responseType="blob",o.send()},t.prototype._imageToContext=function(t){if(!(t instanceof HTMLImageElement))throw r("_initCanvas: Invalid image");var o=document.createElement("canvas").getContext("2d");return o.canvas.width=t.width,o.canvas.height=t.height,o.drawImage(t,0,0),o},t.prototype._arrayMax=function(t){for(var r=t.length,o=0;--r>-1;)t[r]>o&&(o=t[r]);return o},window.ColorFinder=new t}();